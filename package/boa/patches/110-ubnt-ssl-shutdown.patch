diff -uNr boa-0.93.17-uClinux-dist-20051014/src/get.c boa-ubnt-latest/src/get.c
--- boa-0.93.17-uClinux-dist-20051014/src/get.c	2008-06-17 13:44:45.000000000 +0300
+++ boa-ubnt-latest/src/get.c	2008-06-17 13:37:11.000000000 +0300
@@ -183,6 +183,14 @@
 	int bytes_written, bytes_to_write;
 
 	bytes_to_write = req->filesize - req->filepos;
+#ifdef SERVER_SSL
+#ifndef MATRIX_SSL_COMPAT
+	if (bytes_to_write == 0)
+	{
+		goto shutdown_ssl;
+	}
+#endif
+#endif	
 #ifdef USE_NLS
 	if (req->method != M_HEAD)
 	{
@@ -230,8 +238,31 @@
 		}
 	}
 	req->filepos += bytes_written;
+#ifdef SERVER_SSL
+#ifndef MATRIX_SSL_COMPAT
+shutdown_ssl:
+#endif
+#endif	
 	if (req->filepos == req->filesize)	/* EOF */
+	{
+#ifdef SERVER_SSL
+#ifndef MATRIX_SSL_COMPAT
+		if(req->ssl != NULL)
+		{
+			bytes_written = SSL_shutdown(req->ssl);
+			if (handle_io_error_return(req, bytes_written))
+			{
+				if (req->ssl_operation == SSL_ERROR_WANT_READ)
+				{
+					shutdown(req->fd, SHUT_WR);
+				}
+				return -1; /* request blocked at SSL CLOSE_NOTIFY */
+			}
+		}
+#endif
+#endif
 		return 0;
+	}
 	else
 		return 1;				/* more to do */
 }
diff -uNr boa-0.93.17-uClinux-dist-20051014/src/pipe.c boa-ubnt-latest/src/pipe.c
--- boa-0.93.17-uClinux-dist-20051014/src/pipe.c	2008-06-17 13:44:45.000000000 +0300
+++ boa-ubnt-latest/src/pipe.c	2008-06-17 13:37:31.000000000 +0300
@@ -107,11 +107,27 @@
 
 	if (bytes_to_write == 0) {
 		if (req->cgi_status == CGI_CLOSE)
+		{
+#ifdef SERVER_SSL
+#ifndef MATRIX_SSL_COMPAT
+			if(req->ssl != NULL)
+			{
+				bytes_written = SSL_shutdown(req->ssl);
+				if (handle_io_error_return(req, bytes_written))
+				{
+					if (req->ssl_operation == SSL_ERROR_WANT_READ)
+					{
+						shutdown(req->fd, SHUT_WR);
+					}
+					return -1; /* request blocked at SSL CLOSE_NOTIFY */
+				}
+			}
+#endif
+#endif
 			return 0;
+		}
 
-		req->status = PIPE_READ;
-
-		
+		req->status = PIPE_READ;		
 				req->header_end = req->header_line = req->buffer;
 		return 1;
 	}
